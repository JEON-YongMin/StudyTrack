<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Study Track - 과제 추가</title>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<!-- TOP BAR -->
<nav class="navbar navbar-light bg-white shadow-sm">
    <div class="container">
        <a href="/" class="navbar-brand fw-bold text-primary">📖 Study Track</a>

        <div>
            <a th:href="@{/study/{id}(id=${study.id})}" class="btn btn-outline-primary btn-sm me-2">
                스터디로
            </a>
            <span class="fw-semibold me-3" th:text="${user.name}">사용자</span>
            <a href="/logout" class="btn btn-outline-danger btn-sm">로그아웃</a>
        </div>
    </div>
</nav>

<div class="container py-4">

    <!-- BREADCRUMB -->
    <div class="mb-3">
        <div class="text-muted small">
            <a th:href="@{/study/{id}(id=${study.id})}" class="text-decoration-none">스터디</a>
            <span class="mx-1">/</span>
            <a th:href="@{/study/{id}/assignments(id=${study.id})}" class="text-decoration-none">과제</a>
            <span class="mx-1">/</span>
            <span>추가</span>
        </div>
    </div>

    <div class="row">

        <!-- MAIN -->
        <div class="col-md-8">

            <div class="bg-white p-4 rounded shadow-sm mb-4">
                <h3 class="fw-bold mb-1">📚 과제 추가</h3>
                <p class="text-muted mb-4">마감일, 설명, 링크/첨부 등을 입력해 팀원에게 과제를 배포하세요.</p>

                <!-- FORM -->
                <form th:action="@{/assignments}" method="post" enctype="multipart/form-data">

                    <!-- hidden: study id -->
                    <input type="hidden" name="studyId" th:value="${study.id}" value="1">

                    <!-- Title -->
                    <div class="mb-3">
                        <label class="form-label fw-semibold">과제 제목</label>
                        <input type="text" name="title" class="form-control"
                               placeholder="예: 2주차 알고리즘 문제 풀이" required>
                        <div class="form-text">팀원들이 이해하기 쉬운 제목으로 작성해요.</div>
                    </div>

                    <!-- Deadline + Priority -->
                    <div class="row g-3 mb-3">
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">마감일</label>
                            <input type="datetime-local" name="deadline" class="form-control" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">우선순위</label>
                            <select name="priority" class="form-select">
                                <option value="LOW">낮음</option>
                                <option value="MEDIUM" selected>보통</option>
                                <option value="HIGH">높음</option>
                            </select>
                        </div>
                    </div>

                    <!-- Description -->
                    <div class="mb-3">
                        <label class="form-label fw-semibold">설명</label>
                        <textarea name="description" class="form-control" rows="6"
                                  placeholder="과제 요구사항, 제출 방법, 참고 자료 등을 적어주세요."></textarea>
                        <div class="form-text">줄바꿈이 유지되도록 저장(예: TEXT)하면 보기 좋아요.</div>
                    </div>

                    <!-- Link -->
                    <div class="mb-3">
                        <label class="form-label fw-semibold">참고 링크 (선택)</label>
                        <input type="url" name="referenceUrl" class="form-control"
                               placeholder="예: https://github.com/... 또는 문제 링크">
                    </div>

                    <!-- Attachments -->
                    <div class="mb-4">
                        <label class="form-label fw-semibold">첨부파일 (선택)</label>
                        <input type="file" name="files" class="form-control" multiple>
                        <div class="form-text">PDF, 이미지, 텍스트 등 과제 자료를 올릴 수 있어요.</div>
                    </div>

                    <!-- Options -->
                    <div class="border rounded p-3 mb-4">
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" name="requireSubmission"
                                   id="requireSubmission" checked>
                            <label class="form-check-label" for="requireSubmission">
                                제출을 필수로 받기
                            </label>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="notifyMembers"
                                   id="notifyMembers" checked>
                            <label class="form-check-label" for="notifyMembers">
                                멤버에게 알림 보내기 (선택)
                            </label>
                        </div>

                        <div class="form-text mt-2">
                            알림 기능은 나중에 이메일/푸시/내부 알림으로 확장 가능해요.
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="d-flex justify-content-between">
                        <a th:href="@{/study/{id}(id=${study.id})}" class="btn btn-outline-secondary">
                            취소
                        </a>
                        <button type="submit" class="btn btn-primary">
                            과제 생성
                        </button>
                    </div>

                </form>
            </div>

        </div>

        <!-- SIDE -->
        <div class="col-md-4">

            <!-- STUDY SUMMARY -->
            <div class="bg-white p-4 rounded shadow-sm mb-3">
                <h6 class="fw-bold mb-2">📌 스터디 정보</h6>
                <div class="small">
                    <div class="mb-1">
                        <span class="text-muted">스터디명</span><br>
                        <span class="fw-semibold" th:text="${study.title}">알고리즘 스터디</span>
                    </div>
                    <div class="mb-1">
                        <span class="text-muted">멤버</span><br>
                        👥 <span th:text="${study.memberCount}">5</span>명
                    </div>
                    <div>
                        <span class="text-muted">운영자</span><br>
                        <span th:text="${study.ownerName}">홍길동</span>
                    </div>
                </div>
            </div>

            <!-- TIP CARD -->
            <div class="bg-white p-4 rounded shadow-sm mb-3">
                <h6 class="fw-bold mb-2">✅ 작성 팁</h6>
                <ul class="small text-muted mb-0">
                    <li>제목에 “주차/주제”를 넣으면 찾기 쉬워요.</li>
                    <li>설명에는 “제출 형식/기한/평가 기준”을 포함해요.</li>
                    <li>참고 링크는 문제/자료/레포 URL을 추천!</li>
                </ul>
            </div>

            <!-- PREVIEW (simple) -->
            <div class="bg-white p-4 rounded shadow-sm">
                <h6 class="fw-bold mb-2">👀 미리보기</h6>
                <div class="small text-muted">
                    입력한 내용이 실제 과제 카드로 보이는 형태를 상상하기 쉬우라고 넣었어요.
                </div>
                <div class="border rounded p-3 mt-3">
                    <div class="fw-semibold">과제 제목</div>
                    <div class="text-muted small">마감: YYYY-MM-DD HH:mm</div>
                    <span class="badge bg-warning mt-2">진행 중</span>
                </div>
            </div>

        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
